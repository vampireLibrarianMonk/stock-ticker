{% extends 'base.html' %}
{% load timestamp_filters %}
{% block content %}

<h1>Portfolio Management</h1>
<br/>

<form action="{% url 'add_stock' %}" class="form-inline my-2 my-lg-0" method="POST">
    {% csrf_token %}
    <input class="form-control mr-sm-2" type="search" placeholder="Add To Portfolio" aria-label="Search" name="ticker">
    <button class="btn btn-outline-secondary my-2 my-sm-0" type="submit">Add Stock</button>
</form>

<br/><br/>

<table class="table table-bordered table-hover">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Symbol</th>
      <th scope="col">Sector</th>
      <th scope="col">Security Type</th>
      <th scope="col">Bid Price</th>
      <th scope="col">Bid Size</th>
      <th scope="col">Ask Price</th>
      <th scope="col">Ask Size</th>
      <th scope="col">Last Updated</th>
      <th scope="col">Last Sale Price</th>
      <th scope="col">Last Sale Size</th>
      <th scope="col">Last Sale Time</th>
      <th scope="col">Volume</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% if ticker %}
        {% for thing in ticker %}
            {% for item in output %}
                <tr>
                    <td>{{ item.symbol }}</td>
                    <td>{{ item.sector }}</td>
                    <td>{{ item.securityType }}</td>
                    <td>${{ item.bidPrice }}</td>
                    <td>{{ item.bidSize }}</td>
                    <td>${{ item.askPrice }}</td>
                    <td>{{ item.askSize }}</td>
                    <td>{{ item.lastUpdated|milliseconds_to_datetime }}</td>
                    <td>${{ item.lastSalePrice }}</td>
                    <td>{{ item.lastSaleSize }}</td>
                    <td>{{ item.lastSaleTime|milliseconds_to_datetime }}</td>
                    <td>{{ item.volume }}</td>
                    <td>
                        <a href="{% url 'delete_stock_with_id' thing.id %}" class="btn btn-danger">Delete</a>
                    </td>
                </tr>
            {% endfor %}
        {% endfor %}
    {% endif %}
  </tbody>
</table>

{% endblock %}
